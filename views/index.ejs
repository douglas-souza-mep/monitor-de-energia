<!DOCTYPE html>
<head>
  <meta charset="UTF-8" />
  <title>Mep Tecnologia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <link rel="stylesheet" type="text/css" href='/stylesheets/login.css' />
</head>

<body>
  <div class="container" >
    <!--a class="links" id="paracadastro"></a>
    <a class="links" id="paralogin"></a-->
     
    <div class="content">      
      <!--FORMULÁRIO DE LOGIN-->
      <div id="login">

        <form method="post" action=""> 
          <h1>
            <figure >
            <img  src="/images/logo_mep.png" alt="Logo Mep Engenharia">
            </figure>
          </h1> 
          <p> 
            <label for="user">Usuario</label>
            <input id="user" name="user" required="required" type="text" placeholder="ex. meuUsuario"/>
          </p>
          
          <p> 
            <label for="password">Senha</label>
            <input id="password" name="password" required="required" type="password" placeholder="*******" /> 
          </p>
          
          <!--p> 
            <input type="checkbox" name="manterlogado" id="manterlogado" value="" /> 
            <label for="manterlogado">Manter-me logado</label>
          </p-->
          
          <p> 
            <input type="submit" value="Entrar" /> 
          </p>
          
          <!--p class="link">
            Ainda não tem conta?
            <a href="#paracadastro">Cadastre-se</a>
          </p-->
        </form>
      </div>

      <div id="popup"></div>
      <script>
        const form = document.getElementById("loginForm");
        const popup = document.getElementById("popup");
      
        form.addEventListener("submit", async function (event) {
          event.preventDefault(); // evita o envio padrão
      
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());
      
          try {
            const response = await fetch('/', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(data)
            });
      
            const result = await response.json();
      
            if (result.status === 'error') {
              mostrarPopup(result.message);
            } else if (result.status === 'success') {
              alert("✅ Login bem-sucedido!");
              // Redirecionar, se quiser:
              // window.location.href = "/dashboard";
            }
      
          } catch (err) {
            mostrarPopup("Erro de conexão com o servidor.");
          }
        });
      
        function mostrarPopup(mensagem) {
          popup.textContent = mensagem;
          popup.style.display = "block";
          setTimeout(() => popup.style.display = "none", 3000);
        }
      </script>
      
      <!--FORMULÁRIO DE CADASTRO
      <div id="cadastro">
        <form method="post" action=""> 
          <h1>Cadastro</h1> 
           
          <p> 
            <label for="nome_cad">Seu nome</label>
            <input id="nome_cad" name="nome_cad" required="required" type="text" placeholder="nome" />
          </p>
           
          <p> 
            <label for="email_cad">Seu e-mail</label>
            <input id="email_cad" name="email_cad" required="required" type="email" placeholder="contato@htmlecsspro.com"/> 
          </p>
           
          <p> 
            <label for="password_cad">Sua password</label>
            <input id="password_cad" name="password_cad" required="required" type="password" placeholder="ex. 1234"/>
          </p>
           
          <p> 
            <input type="submit" value="Cadastrar"/> 
          </p>
           
          <p class="link">  
            Já tem conta?
            <a href="#paralogin"> Ir para Login </a>
          </p>
        </form-->
      </div>
    </div>
  </div>  
</body>
</html>
